<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contact Us</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            max-width: 600px;
            margin-top: 50px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

<div class="container">
    <h2 class="text-center">BORANG KEBENARAN PINJAM ALAT</h2>
    <form id="contactForm" action="#" method="POST">
        <div class="mb-3">
            <label for="name" class="form-label">NAMA *</label>
            <input type="text" class="form-control" name="name" id="name" style="text-transform: uppercase;" required>
        </div>
        <div class="mb-3">
            <label for="email" class="form-label">EMAIL *</label>
            <input type="email" class="form-control" name="email" id="email" required>
        </div>
        <div class="mb-3">
            <label for="phone" class="form-label">NO TELEFON *</label>
            <input type="tel" class="form-control" name="phone" id="phone" required pattern="[0-9]{10}">
        </div>
        <div class="mb-3">
            <label for="school" class="form-label">SEKOLAH/INSTITUSI *</label>
            <select class="form-control" name="school" id="school" required>
                <option value="">Select school</option>
                <!-- Schools List -->
                <option>SK AYER MANIS</option>
                <option>SK BANDAR PUTRA</option>
                <option>SK BANDAR TENGGARA 1</option>
                <option>SK BANDAR TENGGARA 2</option>
                <option>SK FELDA INAS</option>
                <option>SK FELDA PENGELI TIMUR</option>
                <option>SK FELDA SUNGAI SIBOL</option>
                <option>SK KANGKAR PULAI</option>
                <option>SK KANGKAR PULAI 2</option>
                <option>SK KULAI</option>
                <option>SK KULAI 1</option>
                <option>SK LKTP BUKIT BATU</option>
                <option>SK LKTP BUKIT BESAR</option>
                <option>SK LKTP BUKIT PERMAI</option>
                <option>SK LKTP BUKIT RAMUN</option>
                <option>SK LKTP PASIR RAJA</option>
                <option>SK LKTP SUNGAI SAYONG (INTEG)</option>
                <option>SK MURNI JAYA</option>
                <option>SK POLIS KEM</option>
                <option>SK PUTRA UTAMA</option>
                <option>SK SAYONG PINANG</option>
                <option>SK SEDENAK</option>
                <option>SK SENAI</option>
                <option>SK SENAI UTAMA</option>
                <option>SK SINAR BAHAGIA</option>
                <option>SK SRI GUNUNG PULAI</option>
                <option>SK SRI PULAI PERDANA</option>
                <option>SK TAMAN INDAHPURA 1</option>
                <option>SK TAMAN INDAHPURA 2</option>
                <option>SK TAMAN KOTA KULAI</option>
                <option>SK TAMAN KOTA KULAI 2</option>
                <option>SK TAMAN MUHIBBAH</option>
                <option>SK TAMAN PULAI EMAS</option>
                <option>SK TAMAN SRI PULAI</option>
                <option>SJK(C) BATU</option>
                <option>SJK(C) BEMBAN</option>
                <option>SJK(C) CHING YEH</option>
                <option>SJK(C) KULAI 1</option>
                <option>SJK(C) KULAI 2</option>
                <option>SJK(C) KULAI BESAR</option>
                <option>SJK(C) PEI CHENG</option>
                <option>SJK(C) PULAI</option>
                <option>SJK(C) SALENG</option>
                <option>SJK(C) SAWIT</option>
                <option>SJK(C) SEDENAK</option>
                <option>SJK(C) SEELONG</option>
                <option>SJK(C) SENAI</option>
                <option>SJK(C) SENGKANG</option>
                <option>SJK(C) WOON HWA</option>
                <option>SJK(T) KANGKAR PULAI</option>
                <option>SJK(T) LADANG KELAN</option>
                <option>SJK(T) LADANG KULAI BESAR</option>
                <option>SJK(T) LADANG KULAI OIL PALM</option>
                <option>SJK(T) LADANG SEDENAK</option>
                <option>SM AGAMA BANDAR TENGGARA</option>
                <option>SMK BANDAR PUTRA</option>
                <option>SMK BANDAR PUTRA 2</option>
                <option>SMK BANDAR TENGGARA</option>
                <option>SMK BANDAR TENGGARA 2</option>
                <option>SMK BUKIT BATU</option>
                <option>SMK INDAHPURA 1</option>
                <option>SMK KANGKAR PULAI</option>
                <option>SMK KELAPA SAWIT</option>
                <option>SMK KULAI BESAR</option>
                <option>SMK MUNSHI ABDULLAH</option>
                <option>SMK PULAI JAYA</option>
                <option>SMK SENAI</option>
                <option>SMK SERI PINANG</option>
                <option>SMK SERI PULAI PERDANA</option>
                <option>SMK SULTAN ALAUDDIN</option>
                <option>SMK SULTAN IBRAHIM</option>
                <option>SMK TAMAN KOTA KULAI</option>
                <option>SMK TAMAN PUTRI</option>
                <option>SMK TUNKU ABDUL RAHMAN PUTRA</option>
                <option>SMPK VOKASIONAL INDAHPURA</option>
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">PERALATAN DIPINJAM *</label><br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="tool" id="tool_mikrobotik" value="MIKROBOTIK">
                <label class="form-check-label" for="tool_mikrobotik">MIKROBOTIK</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="tool" id="tool_rekaedukit" value="REKA EDUKIT">
                <label class="form-check-label" for="tool_rekaedukit">REKA EDUKIT</label>
            </div>
        </div>
        <div class="mb-3">
            <label for="mikrobotik" class="form-label">BILANGAN MIKROBOTIK DIPINJAM *</label>
            <input type="text" class="form-control" name="mikrobotik" id="mikrobotik" required>
        </div>
        <div class="mb-3">
            <label for="reka_edukit" class="form-label">BILANGAN REKA EDUKIT DIPINJAM *</label>
            <input type="text" class="form-control" name="reka_edukit" id="reka_edukit" required>
        </div>
        <div class="mb-3">
            <label for="start_date" class="form-label">TARIKH PINJAM *</label>
            <input type="date" class="form-control" name="start_date" id="start_date" required min="">
        </div>
        <div class="mb-3">
            <label for="end_date" class="form-label">TARIKH DIJANGKA PULANG *</label>
            <input type="date" class="form-control" name="end_date" id="end_date" required min="">
        </div>
        <div class="mb-3">
            <label for="comments" class="form-label">TUJUAN </label>
            <textarea class="form-control" name="comments" id="comments" rows="3"></textarea>
        </div>
        <div class="mb-3">
            <label for="fileInput" class="form-label">MUATNAIK SURAT PERMOHONAN (PDF)</label>
            <input type="file" class="form-control" name="fileInput" id="fileInput" accept="application/pdf">
        </div>
        
        <button type="submit" class="btn btn-primary w-100">Submit</button>
    </form>
</div>

<script>

    window.addEventListener("DOMContentLoaded", () => {
        const today = new Date().toISOString().split('T')[0];
        const startDateInput = document.getElementById("start_date");
        const endDateInput = document.getElementById("end_date");

        startDateInput.setAttribute("min", today);
        startDateInput.addEventListener('change', function () {
            const selectedDate = this.value;
            endDateInput.setAttribute("min", selectedDate);
            if (endDateInput.value < selectedDate) {
                endDateInput.value = selectedDate;
            }
        });
    });



    document.getElementById("contactForm").addEventListener("submit", async function(event) {
        event.preventDefault();

       


        let name = document.getElementById("name").value.trim();
        let email = document.getElementById("email").value.trim();
        let phone = document.getElementById("phone").value.trim();
        let school = document.getElementById("school").value.trim();
        let toolElements = document.querySelectorAll('input[name="tool"]:checked');
        let tool = Array.from(toolElements).map(el => el.value).join(', ');
        let mikrobotik = document.getElementById("mikrobotik").value.trim();
        let reka_edukit = document.getElementById("reka_edukit").value.trim();
        let startDate = document.getElementById("start_date").value;
        let endDate = document.getElementById("end_date").value;
        let comments = document.getElementById("comments").value.trim();
        let fileInput = document.getElementById("fileInput").files[0];

        if (name === "" || email === "" || phone === "" || school === "" || toolElements.length === 0 || mikrobotik === "" || reka_edukit === "") {
            alert("Please fill in all required fields.");
            return;
        }

        if (!/^\d{10}$/.test(phone)) {
            alert("Phone number must be 10 digits.");
            return;
        }

        alert("Uploading...");


        if (fileInput && fileInput.type === "application/pdf") {
            const reader = new FileReader();
            reader.onload = async function () {
                const base64 = reader.result.split(',')[1];

                const formData = new URLSearchParams();
                formData.append('name', name);
                formData.append('email', email);
                formData.append('phone', phone);
                formData.append('school', school);
                formData.append('tool', tool);
                formData.append('mikrobotik', mikrobotik);
                formData.append('reka_edukit', reka_edukit);
                formData.append('start_date', startDate);
                formData.append('end_date', endDate);
                formData.append('comments', comments);
                formData.append('filedata', base64);

                try {
                    const response = await fetch('https://script.google.com/macros/s/AKfycbyrOTqAJBzl38KeW_hHe8bm5GyZbAzaGOpEYTt8AMBCZzADqnqmYvDlQwxdNj3P8VeP/exec', {
                        method: 'POST',
                        body: formData
                    });

                    const text = await response.text();
                    alert(text); // After fetch success

                } catch (error) {
                    alert("An error occurred while uploading."); // On error
                }
            };
            reader.readAsDataURL(fileInput);
        } else {
            alert("Please upload a valid PDF file."); // Invalid file
        }
    });
</script>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
